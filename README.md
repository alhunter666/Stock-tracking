ğŸ’° ä¸‰æ¡¶æŠ•èµ„ç»„åˆä»ªè¡¨æ¿ (Three-Bucket Portfolio Dashboard) - V2.0

è¿™æ˜¯ä¸€ä¸ªåŸºäº Streamlit çš„ä¸ªäººæŠ•èµ„ä»ªè¡¨æ¿ï¼Œç”¨äºè·Ÿè¸ªå’Œç®¡ç†"ä¸‰æ¡¶æŠ•èµ„ç­–ç•¥"ã€‚

V2.0 é‡å¤§æ›´æ–°ï¼š æ­¤ç‰ˆæœ¬ç°åœ¨ä½¿ç”¨ Google Sheets ä½œä¸ºåç«¯æ•°æ®åº“ï¼Œä»¥æ°¸ä¹…ä¿å­˜æ‚¨çš„æŒä»“æ•°æ®ã€‚å®ƒè¿˜æ·»åŠ äº†æ‰‹åŠ¨å¸‚å€¼åˆ—ï¼Œä»¥å‡†ç¡®è·Ÿè¸ªæœŸæƒï¼ˆOptionsï¼‰çš„ç›ˆäºã€‚

âœ¨ ä¸»è¦åŠŸèƒ½

æ°¸ä¹…å­˜å‚¨ï¼š æ•°æ®ä¿å­˜åœ¨æ‚¨è‡ªå·±çš„ Google Sheet ä¸­ï¼Œå…³é—­æµè§ˆå™¨æˆ–é‡å¯åº”ç”¨æ•°æ®ä¸ä¼šä¸¢å¤±ã€‚

å‡†ç¡®çš„æœŸæƒè·Ÿè¸ªï¼š æ–°å¢ manual_market_value (æ‰‹åŠ¨å¸‚å€¼) åˆ—ã€‚æ‚¨å¯ä»¥æ‰‹åŠ¨è¾“å…¥æœŸæƒçš„å½“å‰ä»·å€¼ï¼Œåº”ç”¨å°†è‡ªåŠ¨è®¡ç®—å‡†ç¡®çš„ç›ˆäºã€‚

ä¸‰æ¡¶åˆ†ç¦»ï¼š æ¸…æ™°åœ°å°†æŒä»“åˆ†ä¸º "æ¡¶1 (æ ¸å¿ƒ)", "æ¡¶2 (æ”¶å…¥)" å’Œ "æ¡¶3 (æŠ•æœº)"ã€‚

å¯äº¤äº’ç¼–è¾‘ï¼š ç›´æ¥åœ¨ç½‘é¡µè¡¨æ ¼ä¸­ç¼–è¾‘æŒä»“ã€‚

ä¿å­˜æŒ‰é’®ï¼š ç¼–è¾‘åç‚¹å‡» "ğŸ’¾ ä¿å­˜å…¨éƒ¨æ›´æ”¹" æŒ‰é’®ï¼Œå°†ä¿®æ”¹å†™å› Google Sheetã€‚

å®æ—¶ä»·æ ¼ (è‚¡ç¥¨/ETF)ï¼š è‡ªåŠ¨ä½¿ç”¨ yfinance åº“è·å–è‚¡ç¥¨å’ŒETFçš„å®æ—¶å¸‚åœºä»·æ ¼ã€‚

â€¼ï¸ é¦–æ¬¡è®¾ç½®æŒ‡å— (å¿…è¯»)

æ­¤ç‰ˆæœ¬éœ€è¦æ‚¨è¿›è¡Œä¸€æ¬¡æ€§è®¾ç½®ï¼Œä»¥ä¾¿ Streamlit èƒ½è¿æ¥åˆ°æ‚¨çš„ Google Sheetã€‚

ç¬¬1æ­¥ï¼šåˆ›å»ºæ‚¨çš„ Google Sheet

è®¿é—® sheets.new åˆ›å»ºä¸€ä¸ªæ–°çš„è°·æ­Œç”µå­è¡¨æ ¼ã€‚

å°†å…¶å‘½åä¸ºæ‚¨å–œæ¬¢çš„åå­—ï¼ˆä¾‹å¦‚ "MyStockDashboard"ï¼‰ã€‚

åœ¨åº•éƒ¨åˆ›å»º 3 ä¸ªå·¥ä½œè¡¨ (Tabs)ï¼Œå¹¶ç²¾ç¡®å‘½åä¸ºï¼š

æ¡¶1

æ¡¶2

æ¡¶3

è®¾ç½® æ¡¶1 å’Œ æ¡¶3 çš„è¡¨å¤´ (ç¬¬1è¡Œ)ï¼š

A1: ticker

B1: type

C1: quantity

D1: total_cost

E1: notes

F1: manual_market_value

è®¾ç½® æ¡¶2 çš„è¡¨å¤´ (ç¬¬1è¡Œ)ï¼š

A1: strategy

B1: ticker

C1: margin_used

D1: target_premium_monthly

E1: notes

ï¼ˆå¯é€‰ï¼‰åœ¨è¡¨æ ¼ä¸­å¡«å…¥ä¸€äº›æ‚¨çš„åˆå§‹æ•°æ®ã€‚

ç¬¬2æ­¥ï¼šè®¾ç½® Google Cloud API æƒé™

è®¿é—® Google Cloud Consoleã€‚

åˆ›å»ºä¸€ä¸ªæ–°é¡¹ç›®ï¼ˆæˆ–ä½¿ç”¨ç°æœ‰é¡¹ç›®ï¼‰ã€‚

å¯ç”¨ APIï¼š

åœ¨é¡¶éƒ¨çš„æœç´¢æ ä¸­ï¼Œæœç´¢å¹¶å¯ç”¨ "Google Drive API"ã€‚

åœ¨é¡¶éƒ¨çš„æœç´¢æ ä¸­ï¼Œæœç´¢å¹¶å¯ç”¨ "Google Sheets API"ã€‚

åˆ›å»ºæœåŠ¡å¸å· (Service Account)ï¼š

è½¬åˆ° "IAM & Admin" > "Service Accounts"ã€‚

ç‚¹å‡» "Create Service Account"ã€‚

ç»™å®ƒä¸€ä¸ªåå­—ï¼ˆä¾‹å¦‚ "streamlit-stock-app"ï¼‰ï¼Œç‚¹å‡» "Create and Continue"ã€‚

åœ¨ "Role" (è§’è‰²) å¤„ï¼Œé€‰æ‹© "Editor" (ç¼–è¾‘è€…)ã€‚ç‚¹å‡» "Continue" > "Done"ã€‚

åˆ›å»º JSON å¯†é’¥æ–‡ä»¶ï¼š

æ‰¾åˆ°æ‚¨åˆšåˆšåˆ›å»ºçš„æœåŠ¡å¸å·ï¼Œç‚¹å‡»å®ƒçš„ç”µå­é‚®ä»¶åœ°å€ã€‚

è½¬åˆ° "Keys" (å¯†é’¥) æ ‡ç­¾é¡µã€‚

ç‚¹å‡» "Add Key" > "Create new key"ã€‚

é€‰æ‹© "JSON" å¹¶ç‚¹å‡» "Create"ã€‚

ä¸€ä¸ª .json å¯†é’¥æ–‡ä»¶å°†ä¼šä¸‹è½½åˆ°æ‚¨çš„ç”µè„‘ã€‚è¯·å¦¥å–„ä¿ç®¡æ­¤æ–‡ä»¶ï¼Œä¸è¦å…¬å¼€ï¼

åˆ†äº«æ‚¨çš„ Google Sheetï¼š

æ‰“å¼€æ‚¨ä¸‹è½½çš„ .json å¯†é’¥æ–‡ä»¶ï¼ˆç”¨è®°äº‹æœ¬æˆ–ä»»ä½•æ–‡æœ¬ç¼–è¾‘å™¨ï¼‰ã€‚

æ‰¾åˆ°ä¸€è¡Œ "client_email"ï¼ˆä¾‹å¦‚ ...<...@....gserviceaccount.com>)ã€‚

å¤åˆ¶è¿™ä¸ªå®Œæ•´çš„ç”µå­é‚®ä»¶åœ°å€ã€‚

å›åˆ°æ‚¨çš„ Google Sheetï¼Œç‚¹å‡»å³ä¸Šè§’çš„ "Share" (åˆ†äº«)ã€‚

å°†è¿™ä¸ªç”µå­é‚®ä»¶åœ°å€ç²˜è´´è¿›å»ï¼Œç»™äºˆ "Editor" (ç¼–è¾‘è€…) æƒé™ï¼Œç„¶åç‚¹å‡» "Share"ã€‚

ç¬¬3æ­¥ï¼šå°†å¯†é’¥æ·»åŠ åˆ° Streamlit

æ‚¨éœ€è¦è®© Streamlit åº”ç”¨èƒ½â€œè¯»åˆ°â€è¿™ä¸ª .json å¯†é’¥æ–‡ä»¶çš„å†…å®¹ã€‚

å¦‚æœæ‚¨åœ¨ Streamlit Cloud éƒ¨ç½² (æ¨è)ï¼š

ç™»å½• Streamlit Community Cloudã€‚

è½¬åˆ°æ‚¨çš„åº”ç”¨ï¼Œç‚¹å‡»å³ä¸‹è§’çš„ "Settings"ã€‚

è½¬åˆ° "Secrets" éƒ¨åˆ†ã€‚

å¤åˆ¶ç²˜è´´æ‚¨ä¸‹è½½çš„ .json æ–‡ä»¶çš„å…¨éƒ¨å†…å®¹åˆ° Streamlit çš„ Secrets ç¼–è¾‘å™¨ä¸­ã€‚å®ƒçœ‹èµ·æ¥åº”è¯¥åƒè¿™æ ·ï¼š

# secrets.toml

[gsheets]
# æ›¿æ¢ä¸ºæ‚¨ä¸‹è½½çš„ .json æ–‡ä»¶çš„å†…å®¹
type = "service_account"
project_id = "..."
private_key_id = "..."
private_key = "-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----\n"
client_email = "..."
client_id = "..."
auth_uri = "[https://accounts.google.com/o/oauth2/auth](https://accounts.google.com/o/oauth2/auth)"
token_uri = "[https://oauth2.googleapis.com/token](https://oauth2.googleapis.com/token)"
auth_provider_x509_cert_url = "[https://www.googleapis.com/oauth2/v1/certs](https://www.googleapis.com/oauth2/v1/certs)"
client_x509_cert_url = "..."
universe_domain = "googleapis.com"


å¦‚æœæ‚¨åœ¨æœ¬åœ°è¿è¡Œï¼š

åœ¨æ‚¨çš„é¡¹ç›®æ–‡ä»¶å¤¹ï¼ˆapp.py æ‰€åœ¨çš„æ–‡ä»¶å¤¹ï¼‰ä¸­ï¼Œåˆ›å»ºä¸€ä¸ªåä¸º .streamlit çš„æ–‡ä»¶å¤¹ã€‚

åœ¨è¯¥æ–‡ä»¶å¤¹å†…ï¼Œåˆ›å»ºä¸€ä¸ªåä¸º secrets.toml çš„æ–‡ä»¶ã€‚

å°†ä¸Šé¢ç¬¬4æ­¥ä¸­æ˜¾ç¤ºçš„ [gsheets] å¯†é’¥å†…å®¹ç²˜è´´åˆ° secrets.toml æ–‡ä»¶ä¸­ã€‚

ğŸš€ å¦‚ä½•è¿è¡Œ

å®‰è£…æ‰€æœ‰ä¾èµ–åº“ (åŒ…æ‹¬æ–°åº“)ï¼š

pip install -r requirements.txt


è¿è¡Œ Streamlit åº”ç”¨ï¼š

streamlit run app.py


åº”ç”¨å¯åŠ¨æ—¶ï¼Œå®ƒå°†è‡ªåŠ¨å°è¯•è¿æ¥åˆ°æ‚¨çš„ Google Sheet å¹¶åŠ è½½æ•°æ®ï¼
